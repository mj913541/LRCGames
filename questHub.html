<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LRC Quest Hub</title>

  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <style>
    body {
      background: linear-gradient(to bottom, #fff8e1, #f3e8ff);
      min-height: 100vh;
      font-family: 'Poppins', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    .world-btn {
      @apply w-full py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-xl font-semibold transition;
    }
  </style>
</head>

<body class="p-6">
  <!-- Main Container -->
  <div class="max-w-3xl mx-auto bg-white shadow-xl rounded-3xl p-6 mt-10">

    <!-- Greeting Section -->
    <h1 id="studentGreeting" class="text-3xl font-bold mb-1 text-purple-700">
      Welcome, Explorer!
    </h1>

    <p id="studentDetails" class="text-gray-700 mb-1 text-sm">
      Loading your info...
    </p>

    <p id="tierDetails" class="text-gray-500 mb-6 text-xs">
      Tier: (checking...)
    </p>

    <!-- Worlds Section (placeholders for now) -->
    <div class="space-y-3">
      <button class="world-btn">ğŸ“š Genre World</button>
      <button class="world-btn">ğŸ” Research Treehouse</button>
      <button class="world-btn">ğŸ›¡ Digital Citizenship Skylands</button>
      <button class="world-btn">ğŸ› Library Skills Village</button>
      <button class="world-btn">ğŸ–¥ Tech Skills Mountain</button>
      <button class="world-btn">ğŸ¨ Creative Projects Cove</button>
      <button class="world-btn">ğŸ® Lion Head Arcade</button>
    </div>

    <!-- Logout -->
    <button
      id="logoutBtn"
      class="mt-8 w-full py-2.5 bg-red-500 hover:bg-red-600 text-white rounded-xl font-semibold"
    >
      Log Out
    </button>

  </div>

  <!-- Core Logic -->
  <script type="module">
    import {
      requireLogin,
      getLocalStudent,
      getLocalTier,
      getLocalProgress,
      logOut
    } from "./scripts/lrcQuestCore.js";

    const greetingEl = document.getElementById("studentGreeting");
    const detailsEl = document.getElementById("studentDetails");
    const tierEl = document.getElementById("tierDetails");
    const logoutBtn = document.getElementById("logoutBtn");

    function showGreeting(user, student) {
      const name =
        (student && student.fullName) ||
        user.displayName ||
        "Explorer";

      const email =
        (student && student.email) ||
        user.email ||
        "";

      greetingEl.textContent = `ğŸ¦ Welcome, ${name}!`;
      detailsEl.textContent = email
        ? `Signed in as ${email}`
        : "Signed in with your school Google account.";

      const tier = getLocalTier();
      tierEl.textContent = `Tier: ${tier}`;

      // Optional: peek at progress in console for now
      const progress = getLocalProgress();
      console.log("LRC Quest progress for this player:", progress);
    }

    // Make sure only logged-in kids can see the hub
    requireLogin((user) => {
      const student = getLocalStudent();
      showGreeting(user, student);
    });

    // Logout button
    logoutBtn.addEventListener("click", async () => {
      await logOut();
    });
  </script>
</body>
</html>
