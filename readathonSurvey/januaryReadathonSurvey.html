<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üìö Read-A-Thon Survey</title>

  <style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --ink:#1f2937;
      --muted:#6b7280;
      --accent:#3b82f6;
      --border:#e5e7eb;
      --ok:#16a34a;
      --bad:#dc2626;
    }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: linear-gradient(180deg, #eef2ff, #f8fafc);
      color: var(--ink);
      padding: 20px;
      display:flex;
      justify-content:center;
    }

    .wrap{ width:min(900px, 100%); }

    .card{
      background: var(--card);
      border:1px solid var(--border);
      border-radius:18px;
      padding:20px;
      box-shadow: 0 10px 25px rgba(0,0,0,.08);
    }

    h1{ margin:0 0 6px; font-size: clamp(1.4rem, 3vw, 2rem); }
    .sub{ margin:0 0 12px; color:var(--muted); line-height:1.5; }

    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; flex-wrap:wrap;
      margin-bottom: 14px;
      padding: 12px;
      border:1px solid var(--border);
      border-radius:14px;
      background:#f8fafc;
    }
    .progressText{ font-weight:800; }
    .progressTrack{
      flex: 1;
      min-width: 220px;
      height: 10px;
      background:#e9eef8;
      border-radius:999px;
      overflow:hidden;
      border:1px solid var(--border);
    }
    .progressBar{
      height:100%;
      width:0%;
      background: var(--accent);
      border-radius:999px;
      transition: width .25s ease;
    }

    label{ display:block; font-weight:800; margin:14px 0 6px; }
    .help{ margin-top:6px; color: var(--muted); font-size: .95rem; }

    select, input[type="text"], textarea{
      width:100%;
      box-sizing:border-box;
      padding:12px 14px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#ffffff;
      color:var(--ink);
      font-size:1rem;
    }
    textarea{ min-height:90px; resize:vertical; }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width: 720px){
      .grid{ grid-template-columns: 1fr; }
    }

    .checks{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      margin-top:6px;
    }
    .checks label{
      font-weight:700;
      background:#f1f5f9;
      border:1px solid var(--border);
      padding:8px 12px;
      border-radius:999px;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:6px;
      margin:0;
    }
    .checks input{ accent-color: var(--accent); }

    .hr{
      height:1px;
      background:var(--border);
      margin:18px 0;
    }

    .step{ display:none; }
    .step.active{ display:block; }

    .btnRow{
      display:flex;
      gap:12px;
      margin-top:18px;
      flex-wrap:wrap;
      justify-content: space-between;
      align-items:center;
    }

    .btnGroup{ display:flex; gap:12px; flex-wrap:wrap; }

    button{
      border:1px solid var(--border);
      background:#f8fafc;
      color:var(--ink);
      padding:12px 18px;
      border-radius:14px;
      font-weight:900;
      cursor:pointer;
      font-size:1rem;
    }
    button.primary{
      background: var(--accent);
      color:#ffffff;
      border-color: var(--accent);
    }
    button:disabled{
      opacity:.55;
      cursor:not-allowed;
    }

    .msg{ margin-top:12px; font-weight:700; }
    .ok{ color: var(--ok); }
    .bad{ color: var(--bad); }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h1>üìö Read-A-Thon Ideas Survey</h1>
      <p class="sub">Earn everything with <b>reading minutes</b> only. No real money. Answer a few questions at a time.</p>

      <div class="topbar">
        <div class="progressText" id="progressText">Step 1 of 8</div>
        <div class="progressTrack" aria-label="progress">
          <div class="progressBar" id="progressBar"></div>
        </div>
      </div>

      <script>
        const ENDPOINT = "https://script.google.com/macros/s/AKfycbzYb0s4THN4hcBm7X9hDeIKRToDSuQWbxRje-wVwiR9f38KJ0X8l82Aa0hw-LO8OsO3cQ/exec";
      </script>

      <form id="survey">
        <!-- STEP 1 -->
        <section class="step active" data-step="1">
          <div class="grid">
            <div>
              <label>1) What grade are you in?</label>
              <select name="grade" required>
                <option value="">Choose‚Ä¶</option>
                <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
              </select>
            </div>

            <div>
              <label>2) Who is your teacher?</label>
              <select name="teacher" required>
                <option value="">Choose‚Ä¶</option>
                <!-- Replace these with your actual teacher list -->
                <option>Mrs. ____</option>
                <option>Mr. ____</option>
                <option>Ms. ____</option>
                <option>Other / Not sure</option>
              </select>
              <div class="help">If you chose ‚ÄúOther‚Äù, type it here:</div>
              <input type="text" name="teacherOther" placeholder="Teacher name (optional)" />
            </div>
          </div>
        </section>

        <!-- STEP 2 -->
        <section class="step" data-step="2">
          <label>3) What should our reading currency be called?</label>
          <input type="text" name="currencyName" placeholder="Book Bucks, Page Points, Story Tokens..." />
          <div class="help">Other (type your idea):</div>
          <input type="text" name="currencyOther" placeholder="Type your own currency name..." />

          <label>4) How often should the ‚Äústore‚Äù be open?</label>
          <select name="spendFrequency">
            <option value="">Choose‚Ä¶</option>
            <option>Anytime</option>
            <option>Once a week</option>
            <option>At the end only</option>
            <option>Special store days</option>
          </select>
        </section>

        <!-- STEP 3 -->
        <section class="step" data-step="3">
          <label>5) What types of avatars do you want? (pick all)</label>
          <div class="checks" data-group="avatarTypes">
            <label><input type="checkbox" value="Animals"> Animals</label>
            <label><input type="checkbox" value="Fantasy (dragons, wizards)"> Fantasy</label>
            <label><input type="checkbox" value="Robots/sci-fi"> Robots/Sci-Fi</label>
            <label><input type="checkbox" value="Cute/funny characters"> Cute/Funny</label>
            <label><input type="checkbox" value="Book-themed characters"> Book-themed</label>
          </div>
          <div class="help">Other (type your idea):</div>
          <input type="text" name="avatarTypesOther" placeholder="Type another avatar idea..." />

          <label>6) Do you want avatars to feel‚Ä¶</label>
          <select name="avatarVibe">
            <option value="">Choose‚Ä¶</option>
            <option>Cute</option>
            <option>Cool</option>
            <option>Funny</option>
            <option>Epic</option>
            <option>A mix</option>
          </select>
          <div class="help">Other (type your idea):</div>
          <input type="text" name="avatarVibeOther" placeholder="Type another vibe idea..." />
        </section>

        <!-- STEP 4 -->
        <section class="step" data-step="4">
          <label>7) Do you want pets?</label>
          <select name="wantsPets">
            <option value="">Choose‚Ä¶</option>
            <option>Yes!</option>
            <option>Maybe</option>
            <option>No thanks</option>
          </select>

          <label>8) What kinds of pets should we include? (pick all)</label>
          <div class="checks" data-group="petTypes">
            <label><input type="checkbox" value="Real animals"> Real animals</label>
            <label><input type="checkbox" value="Magical creatures"> Magical creatures</label>
            <label><input type="checkbox" value="Tiny cute creatures"> Tiny cute creatures</label>
            <label><input type="checkbox" value="Robot pets"> Robot pets</label>
            <label><input type="checkbox" value="Book-themed pets"> Book-themed</label>
          </div>
          <div class="help">Other (type your idea):</div>
          <input type="text" name="petTypesOther" placeholder="Type another pet idea..." />
        </section>

        <!-- STEP 5 -->
        <section class="step" data-step="5">
          <label>9) What items should avatars unlock? (pick all)</label>
          <div class="checks" data-group="itemTypes">
            <label><input type="checkbox" value="Hats"> Hats</label>
            <label><input type="checkbox" value="Glasses"> Glasses</label>
            <label><input type="checkbox" value="Capes"> Capes</label>
            <label><input type="checkbox" value="Costumes"> Costumes</label>
            <label><input type="checkbox" value="Badges/titles"> Badges/Titles</label>
            <label><input type="checkbox" value="Effects (sparkles/glow)"> Effects</label>
          </div>
          <div class="help">Other (type your idea):</div>
          <input type="text" name="itemTypesOther" placeholder="Type another item idea..." />

          <label>10) What should cost the MOST reading minutes? (pick all)</label>
          <div class="checks" data-group="highCostItems">
            <label><input type="checkbox" value="Rare outfits"> Rare outfits</label>
            <label><input type="checkbox" value="Rare pets"> Rare pets</label>
            <label><input type="checkbox" value="Special badges"> Special badges</label>
            <label><input type="checkbox" value="Room decorations"> Room decorations</label>
            <label><input type="checkbox" value="Mystery surprise"> Mystery surprise</label>
          </div>
          <div class="help">Other (type your idea):</div>
          <input type="text" name="highCostOther" placeholder="Type another high-cost idea..." />
        </section>

        <!-- STEP 6 -->
        <section class="step" data-step="6">
          <label>11) What room/background themes should we have? (pick all)</label>
          <div class="checks" data-group="roomThemes">
            <label><input type="checkbox" value="Library/Reading room"> Library</label>
            <label><input type="checkbox" value="Castle"> Castle</label>
            <label><input type="checkbox" value="Forest"> Forest</label>
            <label><input type="checkbox" value="Space"> Space</label>
            <label><input type="checkbox" value="Cozy bedroom"> Cozy</label>
            <label><input type="checkbox" value="Underwater"> Underwater</label>
            <label><input type="checkbox" value="Jungle"> Jungle</label>
          </div>
          <div class="help">Other (type your idea):</div>
          <input type="text" name="roomThemesOther" placeholder="Type another room idea..." />

          <label>12) What decor should be in the room? (pick all)</label>
          <div class="checks" data-group="decorTypes">
            <label><input type="checkbox" value="Posters"> Posters</label>
            <label><input type="checkbox" value="Banners"> Banners</label>
            <label><input type="checkbox" value="Bookshelves"> Bookshelves</label>
            <label><input type="checkbox" value="Pet area"> Pet area</label>
            <label><input type="checkbox" value="Trophy shelf"> Trophy shelf</label>
          </div>
          <div class="help">Other (type your idea):</div>
          <input type="text" name="decorOther" placeholder="Type another decor idea..." />
        </section>

        <!-- STEP 7 (your 2 new questions) -->
        <section class="step" data-step="7">
          <label>13) Besides avatar stuff, what else should you spend LRC Minute currency on?</label>
          <textarea name="otherSpendIdeas" placeholder="Examples: mystery boxes, raffle tickets, special game access‚Ä¶"></textarea>

          <label>14) What should streaks help you win?</label>
          <textarea name="streakRewards" placeholder="Examples: bonus minutes, rare items, badges, pets‚Ä¶"></textarea>
        </section>

        <!-- STEP 8 -->
        <section class="step" data-step="8">
          <label>15) If we did a fundraiser for novelty prizes, what would you WANT? (pick all)</label>
          <div class="checks" data-group="fundraiserPrizeInterests">
            <label><input type="checkbox" value="Stickers"> Stickers</label>
            <label><input type="checkbox" value="Bookmarks"> Bookmarks</label>
            <label><input type="checkbox" value="Fun pens/pencils"> Pens/Pencils</label>
            <label><input type="checkbox" value="Keychains"> Keychains</label>
            <label><input type="checkbox" value="Squishies"> Squishies</label>
            <label><input type="checkbox" value="Fidgets"> Fidgets</label>
            <label><input type="checkbox" value="Small plushies"> Small plushies</label>
            <label><input type="checkbox" value="Mystery prize"> Mystery prize</label>
          </div>
          <div class="help">Other (type your idea):</div>
          <input type="text" name="fundraiserOther" placeholder="Type another prize idea..." />

          <label>16) What ONE prize would you be most excited to earn?</label>
          <input type="text" name="topPrize" placeholder="Example: squishy, keychain, plushie..." />

          <label>17) Some ideas you REALLY want us to include:</label>
          <textarea name="oneBigIdea" placeholder="Tell us your best ideas!"></textarea>
        </section>

        <div class="btnRow">
          <div class="btnGroup">
            <button type="button" id="backBtn">‚¨Ö Back</button>
            <button type="button" class="primary" id="nextBtn">Next ‚ûú</button>
          </div>
          <button type="button" id="resetBtn">üîÑ Clear</button>
        </div>

        <div class="msg" id="msg"></div>
      </form>
    </div>
  </div>

  <script>
    const form = document.getElementById("survey");
    const msg = document.getElementById("msg");
    const resetBtn = document.getElementById("resetBtn");
    const backBtn = document.getElementById("backBtn");
    const nextBtn = document.getElementById("nextBtn");

    const progressText = document.getElementById("progressText");
    const progressBar = document.getElementById("progressBar");

    const steps = Array.from(document.querySelectorAll(".step"));
    let stepIndex = 0; // 0-based

    function showStep(i){
      steps.forEach((s, idx) => s.classList.toggle("active", idx === i));
      const humanStep = i + 1;
      progressText.textContent = `Step ${humanStep} of ${steps.length}`;
      progressBar.style.width = `${(humanStep / steps.length) * 100}%`;

      backBtn.disabled = (i === 0);

      // On last step, Next becomes Submit
      if (i === steps.length - 1){
        nextBtn.textContent = "‚úÖ Submit";
      } else {
        nextBtn.textContent = "Next ‚ûú";
      }

      msg.textContent = "";
      msg.className = "msg";
    }

    function getChecked(groupName){
      const boxWrap = document.querySelector(`[data-group="${groupName}"]`);
      if(!boxWrap) return [];
      return Array.from(boxWrap.querySelectorAll("input[type=checkbox]:checked")).map(cb => cb.value);
    }

    function validateCurrentStep(){
      // Only enforce required fields in Step 1 (grade + teacher)
      if (stepIndex === 0){
        const grade = form.querySelector('[name="grade"]').value;
        const teacher = form.querySelector('[name="teacher"]').value;
        if(!grade || !teacher){
          msg.textContent = "Please choose your grade and teacher to continue.";
          msg.className = "msg bad";
          return false;
        }
      }
      return true;
    }

    resetBtn.addEventListener("click", () => {
      form.reset();
      stepIndex = 0;
      showStep(stepIndex);
    });

    backBtn.addEventListener("click", () => {
      if (stepIndex > 0){
        stepIndex--;
        showStep(stepIndex);
      }
    });

    nextBtn.addEventListener("click", async () => {
      if (!validateCurrentStep()) return;

      // If not last step, just advance
      if (stepIndex < steps.length - 1){
        stepIndex++;
        showStep(stepIndex);
        return;
      }

      // Last step -> submit
      msg.textContent = "Submitting‚Ä¶";
      msg.className = "msg";

      const fd = new FormData(form);

      const payload = {
        grade: fd.get("grade"),
        teacher: fd.get("teacher"),
        teacherOther: fd.get("teacherOther"),

        currencyName: fd.get("currencyName"),
        currencyOther: fd.get("currencyOther"),
        spendFrequency: fd.get("spendFrequency"),

        avatarTypes: getChecked("avatarTypes"),
        avatarTypesOther: fd.get("avatarTypesOther"),
        avatarVibe: fd.get("avatarVibe"),
        avatarVibeOther: fd.get("avatarVibeOther"),

        wantsPets: fd.get("wantsPets"),
        petTypes: getChecked("petTypes"),
        petTypesOther: fd.get("petTypesOther"),

        itemTypes: getChecked("itemTypes"),
        itemTypesOther: fd.get("itemTypesOther"),

        highCostItems: getChecked("highCostItems"),
        highCostOther: fd.get("highCostOther"),

        roomThemes: getChecked("roomThemes"),
        roomThemesOther: fd.get("roomThemesOther"),

        decorTypes: getChecked("decorTypes"),
        decorOther: fd.get("decorOther"),

        otherSpendIdeas: fd.get("otherSpendIdeas"),
        streakRewards: fd.get("streakRewards"),

        fundraiserPrizeInterests: getChecked("fundraiserPrizeInterests"),
        fundraiserOther: fd.get("fundraiserOther"),

        topPrize: fd.get("topPrize"),
        oneBigIdea: fd.get("oneBigIdea")
      };

      try{
        const res = await fetch(ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify(payload)
        });
        const out = await res.json();

        if(out.ok){
          msg.textContent = "‚úÖ Submitted! Thank you!";
          msg.className = "msg ok";
          form.reset();
          stepIndex = 0;
          showStep(stepIndex);
        } else {
          msg.textContent = "‚ùå Something went wrong: " + (out.error || "Unknown error");
          msg.className = "msg bad";
        }
      } catch(err){
        msg.textContent = "‚ùå Could not submit. " + err;
        msg.className = "msg bad";
      }
    });

    // init
    showStep(stepIndex);
  </script>
</body>
</html>
